<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Error interno del servidor - Infojis Sistema de Información Escolar" />
  <title>Error del Servidor | Infojis</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="../../static/css/errors/500.css">
</head>

<body>

  <!-- Floating Background Shapes -->
  <div class="floating-shapes">
    <div class="shape w-32 h-32 bg-white rounded-circle"></div>
    <div class="shape w-24 h-24" style="background-color: #dc2626; border-radius: 50%;"></div>
    <div class="shape w-40 h-40" style="background-color: #1f2937; border-radius: 50%;"></div>
    <div class="shape w-20 h-20" style="background-color: #ff6600; border-radius: 50%;"></div>
  </div>

  <!-- Spark Effects -->
  <div class="spark-effect"></div>
  <div class="spark-effect"></div>
  <div class="spark-effect"></div>

  <!-- Main Content -->
  <div class="container-fluid px-4 py-4">
    <div class="row justify-content-center">
      <div class="col-12 col-lg-10 col-xl-8">
        <div class="glass-effect rounded-4 shadow-lg p-4 p-md-5 p-lg-6 animate-shake">
          <div class="row align-items-center g-4 g-md-5 g-lg-6">

            <!-- Text Content -->
            <div class="col-lg-6 text-center text-lg-start animate-fade-in-up">
              <!-- Logo/Brand -->
              <div class="mb-4 mb-md-5">
                <span class="display-5 fw-bold" translate="no" lang="zxx">
                  <span style="color: #ff6600;">Info</span><span style="color: #2d3748;">jis</span>
                </span>
              </div>

              <!-- 500 Number -->
              <h1 class="number-500 display-1 fw-black mb-4 mb-md-5 animate-glitch">
                500
              </h1>

              <!-- Error Message -->
              <h2 class="h1 fw-bold mb-3 mb-md-4" style="color: #2d3748;">
                ¡Error interno del servidor!
              </h2>

              <p class="fs-5 mb-4 mb-md-5" style="color: #718096; max-width: 540px;">
                Nuestros servidores están experimentando dificultades técnicas. Ya estamos trabajando para solucionarlo.
              </p>

              <!-- Error Code Display -->
              <div class="error-code mb-4 mb-md-5">
                <div>HTTP 500 - Internal Server Error</div>
                <div>Timestamp: <span id="timestamp"></span></div>
                <div>Status: <span style="color: #dc2626;">FAILED</span> <span class="blinking-cursor">|</span></div>
              </div>

              <!-- Retry Counter -->
              <div class="mb-4 mb-md-5 d-flex justify-content-center justify-content-lg-start">
                <div class="retry-counter">
                  <i class="fas fa-clock" style="color: #dc2626;"></i>
                  <span>Reintentando en <span id="countdown">30</span>s</span>
                </div>
              </div>

              <!-- Action Buttons -->
              <div
                class="d-flex flex-column flex-sm-row gap-3 justify-content-center justify-content-lg-start mb-4 mb-md-5">
                <button onclick="retryPage()"
                  class="hover-lift btn btn-error-custom btn-lg px-4 py-3 fw-semibold shadow">
                  <i class="fas fa-redo me-2"></i>
                  Reintentar ahora
                </button>
                <button onclick="goHome()"
                  class="hover-lift btn btn-outline-primary-custom btn-lg px-4 py-3 fw-semibold">
                  <i class="fas fa-home me-2"></i>
                  Ir al inicio
                </button>
              </div>
            </div>

            <!-- Server Illustration -->
            <div class="col-lg-6 animate-slide-in-right">
              <div class="position-relative">
                <!-- Main Server Container -->
                <div class="position-relative rounded-4 p-4 p-md-5 p-lg-6 animate-float"
                  style="background: linear-gradient(to bottom right, #fff8f0, #f0f8ff);">

                  <!-- Server Stack Illustration -->
                  <div class="text-center">
                    <div class="d-inline-block position-relative server-icon">

                      <!-- Server Icon -->
                      <div class="mx-auto mb-4 mb-md-5 position-relative" style="width: 10rem; height: 10rem;">
                        <div class="position-absolute top-0 start-0 w-100 h-100 rounded-3"
                          style="background: linear-gradient(to bottom right, #ef4444, #dc2626); opacity: 0.2; animation: pulse-custom 2s infinite;">
                        </div>
                        <i class="fas fa-server position-absolute top-50 start-50 translate-middle"
                          style="font-size: 4.5rem; color: #dc2626;"></i>
                        <div class="status-indicator"></div>
                      </div>

                      <!-- Warning Icons -->
                      <div
                        class="position-absolute top-0 end-0 w-2 h-2 rounded-circle d-flex align-items-center justify-content-center animate-bounce"
                        style="background-color: #f59e0b; animation-delay: 0.5s; transform: translate(1rem, -1rem); width: 2rem; height: 2rem;">
                        <i class="fas fa-exclamation text-white" style="font-size: 0.75rem;"></i>
                      </div>
                      <div
                        class="position-absolute bottom-0 start-0 w-2 h-2 rounded-circle d-flex align-items-center justify-content-center animate-bounce"
                        style="background-color: #dc2626; animation-delay: 1s; transform: translate(-1rem, 1rem); width: 2rem; height: 2rem;">
                        <i class="fas fa-times text-white" style="font-size: 0.75rem;"></i>
                      </div>
                      <div
                        class="position-absolute top-50 start-0 w-1-5 h-1-5 rounded-circle d-flex align-items-center justify-content-center animate-bounce"
                        style="background-color: #f97316; animation-delay: 1.5s; transform: translate(-2rem, -50%); width: 1.5rem; height: 1.5rem;">
                        <i class="fas fa-bolt text-white" style="font-size: 0.6rem;"></i>
                      </div>
                    </div>

                    <!-- Server Status -->
                    <div class="bg-white rounded-3 p-4 shadow">
                      <div class="d-flex align-items-center justify-content-center mb-3">
                        <div class="w-0-75 h-0-75 bg-danger rounded-circle me-2 animate-pulse"
                          style="width: 0.75rem; height: 0.75rem;"></div>
                        <p class="text-danger fw-bold mb-0">SERVIDOR INACTIVO</p>
                      </div>

                      <!-- Status Bars -->
                      <div class="space-y-3">
                        <div class="d-flex justify-between align-items-center">
                          <span class="text-sm" style="color: #718096;">CPU</span>
                          <div class="w-6"
                            style="height: 0.5rem; background-color: #e5e7eb; border-radius: 0.25rem; overflow: hidden;">
                            <div class="h-100 bg-danger rounded-pill animate-pulse" style="width: 95%"></div>
                          </div>
                        </div>
                        <div class="d-flex justify-between align-items-center">
                          <span class="text-sm" style="color: #718096;">RAM</span>
                          <div class="w-6"
                            style="height: 0.5rem; background-color: #e5e7eb; border-radius: 0.25rem; overflow: hidden;">
                            <div class="h-100 bg-warning rounded-pill animate-pulse" style="width: 85%"></div>
                          </div>
                        </div>
                        <div class="d-flex justify-between align-items-center">
                          <span class="text-sm" style="color: #718096;">DISK</span>
                          <div class="w-6"
                            style="height: 0.5rem; background-color: #e5e7eb; border-radius: 0.25rem; overflow: hidden;">
                            <div class="h-100"
                              style="background-color: #f97316; border-radius: 0.25rem; animation: pulse 2s infinite; width: 75%">
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Background Decorative Elements -->
                <div class="position-absolute top-0 start-0 w-4 h-4 rounded-circle"
                  style="background: linear-gradient(to bottom right, #ef4444, #dc2626); opacity: 0.2; z-index: -1; transform: translate(-2rem, -2rem); width: 4rem; height: 4rem;">
                </div>
                <div class="position-absolute bottom-0 end-0 w-6 h-6 rounded-circle"
                  style="background: linear-gradient(to bottom right, #9ca3af, #4b5563); opacity: 0.2; z-index: -1; transform: translate(2rem, 2rem); width: 6rem; height: 6rem;">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Scripts -->
  <script>
    let countdownTimer;
    let retryCount = 0;
    const maxRetries = 3;

    // Initialize page
    document.addEventListener('DOMContentLoaded', function () {
      updateTimestamp();
      generateErrorId();
      startCountdown();

      // Animate elements on load
      const animatedElements = document.querySelectorAll('.animate-fade-in-up, .animate-slide-in-right');
      animatedElements.forEach((el, index) => {
        el.style.animationDelay = `${index * 0.2}s`;
      });

      // Add mouse tracking effect to glass panel
      const glassPanel = document.querySelector('.glass-effect');
      glassPanel.addEventListener('mousemove', function (e) {
        const rect = this.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        const centerX = rect.width / 2;
        const centerY = rect.height / 2;
        const rotateX = (y - centerY) / 30;
        const rotateY = (centerX - x) / 30;

        this.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
      });

      glassPanel.addEventListener('mouseleave', function () {
        this.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg)';
      });
    });

    // Update timestamp
    function updateTimestamp() {
      const now = new Date();
      document.getElementById('timestamp').textContent = now.toLocaleString();
    }

    // Generate random error ID
    function generateErrorId() {
      const errorId = 'ERR-' + Math.random().toString(36).substr(2, 9).toUpperCase();
      document.getElementById('error-id').textContent = errorId;
    }

    // Countdown timer
    function startCountdown() {
      let timeLeft = 30;
      const countdownElement = document.getElementById('countdown');

      countdownTimer = setInterval(() => {
        timeLeft--;
        countdownElement.textContent = timeLeft;

        if (timeLeft <= 0) {
          clearInterval(countdownTimer);
          if (retryCount < maxRetries) {
            retryPage();
          } else {
            showMaxRetriesReached();
          }
        }
      }, 1000);
    }

    // Navigation functions
    function retryPage() {
      retryCount++;
      if (retryCount <= maxRetries) {
        // Show loading state
        showLoadingState();

        // Simulate retry attempt
        setTimeout(() => {
          // In a real scenario, you would reload the page or make an API call
          // For demo purposes, we'll just restart the countdown
          clearInterval(countdownTimer);
          updateTimestamp();
          generateErrorId();
          startCountdown();
          hideLoadingState();
        }, 2000);
      } else {
        showMaxRetriesReached();
      }
    }

    function showLoadingState() {
      const retryButton = document.querySelector('button[onclick="retryPage()"]');
      retryButton.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Reintentando...';
      retryButton.disabled = true;
      retryButton.classList.add('opacity-50');
    }

    function hideLoadingState() {
      const retryButton = document.querySelector('button[onclick="retryPage()"]');
      retryButton.innerHTML = '<i class="fas fa-redo me-2"></i>Reintentar ahora';
      retryButton.disabled = false;
      retryButton.classList.remove('opacity-50');
    }

    function showMaxRetriesReached() {
      const retryCounter = document.querySelector('.retry-counter');
      retryCounter.innerHTML = '<i class="fas fa-times me-2" style="color: #dc2626;"></i><span>Máximo de reintentos alcanzado</span>';
      retryCounter.style.background = 'linear-gradient(45deg, #fee2e2, #fecaca)';
      retryCounter.style.borderColor = '#fca5a5';
    }

    function goHome() {
      // Replace with your home URL
      window.location.href = '/';
    }

    function goBack() {
      if (window.history.length > 1) {
        window.history.back();
      } else {
        goHome();
      }
    }

    function contactSupport() {
      const errorId = document.getElementById('error-id').textContent;
      const timestamp = document.getElementById('timestamp').textContent;
      const subject = encodeURIComponent(`Error 500 - ${errorId}`);
      const body = encodeURIComponent(`Error interno del servidor reportado.\n\nID del Error: ${errorId}\nTimestamp: ${timestamp}\nPágina: ${window.location.href}\n\nPor favor, describe lo que estabas haciendo cuando ocurrió el error:`);

      window.location.href = `mailto:soporte@infojis.com?subject=${subject}&body=${body}`;
    }

    function checkStatus() {
      // Replace with your status page URL
      window.open('https://status.infojis.com', '_blank');
    }

    // Keyboard navigation
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Enter' || e.key === ' ') {
        retryPage();
      } else if (e.key === 'Escape') {
        goHome();
      } else if (e.key === 'r' || e.key === 'R') {
        retryPage();
      }
    });

    // Cleanup on page unload
    window.addEventListener('beforeunload', function () {
      if (countdownTimer) {
        clearInterval(countdownTimer);
      }
    });
  </script>
</body>

</html>